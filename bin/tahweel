#!/usr/bin/env ruby

# frozen_string_literal: true

# Add the ../lib directory to the load path so we can require 'tahweel'
$LOAD_PATH.unshift(File.expand_path("../lib", __dir__))

require "tahweel"

begin
  options = Tahweel::CLI::Options.parse(ARGV)

  input_path = File.expand_path(ARGV[0])

  Tahweel::CLI::FileCollector.collect(input_path, extensions: options[:extensions]).each do |file|
    Tahweel::CLI::FileProcessor.process(file, options.merge(base_input_path: input_path))
  end
rescue StandardError => e
  abort "Error: #{e.message}"
end
